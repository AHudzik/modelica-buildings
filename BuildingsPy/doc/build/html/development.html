<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Development &mdash; BuildingsPy v0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="BuildingsPy v0.0.1 documentation" href="index.html" />
    <link rel="next" title="Copyright and License" href="legal.html" />
    <link rel="prev" title="Examples" href="examples.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="legal.html" title="Copyright and License"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">BuildingsPy v0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="#">Development</a><ul>
<li><a class="reference external" href="#buildingspy-development-module-for-development-of-the-modelica-library"><tt class="docutils literal"><span class="pre">buildingspy.development</span></tt> Module for development of the Modelica library</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="examples.html"
                                  title="previous chapter">Examples</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="legal.html"
                                  title="next chapter">Copyright and License</a></p>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-buildingspy.development.unittest">
<h1>Development<a class="headerlink" href="#module-buildingspy.development.unittest" title="Permalink to this headline">¶</a></h1>
<div class="section" id="buildingspy-development-module-for-development-of-the-modelica-library">
<h2><tt class="xref docutils literal"><span class="pre">buildingspy.development</span></tt> Module for development of the Modelica library<a class="headerlink" href="#buildingspy-development-module-for-development-of-the-modelica-library" title="Permalink to this headline">¶</a></h2>
<p>This module contains the class <em>Tester</em> that can be
used to run the unit tests of the <cite>Buildings</cite> library.</p>
</div>
<dl class="class">
<dt id="buildingspy.development.unittest.Tester">
<em class="property">class </em><tt class="descclassname">buildingspy.development.unittest.</tt><tt class="descname">Tester</tt><a class="headerlink" href="#buildingspy.development.unittest.Tester" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that runs all unit tests using Dymola.</p>
<p>This class can be used to run all unit tests.
It searches the directory <tt class="docutils literal"><span class="pre">Buildings\Resources\Scripts\Dymola</span></tt> for 
all <tt class="docutils literal"><span class="pre">*.mos</span></tt> files that contain the string <tt class="docutils literal"><span class="pre">simulate</span></tt>. 
All these files will be executed as part of the unit tests.
Any variables or parameters that are plotted by these <tt class="docutils literal"><span class="pre">*.mos</span></tt> files
will be compared to previous results that are stored in 
<tt class="docutils literal"><span class="pre">Buildings\Resources\ReferenceResults\Dymola</span></tt>.
If no reference results exist, then they will be created.
Otherwise, the accuracy of the new results is compared to the
reference results. If they differ by more than a prescibed
tolerance, a plot is shown that shows the old data, the new data
and a vertical line where the biggest error occurs.
The user is then asked to accept or reject the new results.</p>
<p>To run the unit tests, type</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">buildingspy.development.unittest</span> <span class="kn">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Tester</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="buildingspy.development.unittest.Tester.batchMode">
<tt class="descname">batchMode</tt><big>(</big><em>batchMode</em><big>)</big><a class="headerlink" href="#buildingspy.development.unittest.Tester.batchMode" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the batch mode flag.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>batchMode</em> &#8211; Set to <tt class="xref docutils literal"><span class="pre">True</span></tt> to run without interactive prompts 
and without plot windows.</td>
</tr>
</tbody>
</table>
<p>By default, the unit tests require the user to respond if results differ from previous simulations.
This method can be used to run the script in batch mode, suppressing all prompts that require
the user to enter a response. If run in batch mode, no new results will be stored.
To run the unit tests in batch mode, enter</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">buildingspy.development.unittest</span> <span class="kn">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Tester</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">batchMode</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="buildingspy.development.unittest.Tester.checkPythonModuleAvailability">
<tt class="descname">checkPythonModuleAvailability</tt><big>(</big><big>)</big><a class="headerlink" href="#buildingspy.development.unittest.Tester.checkPythonModuleAvailability" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether all required python modules are installed.</p>
<p>If some modules are missing, then an <cite>ImportError</cite> is raised.</p>
</dd></dl>

<dl class="method">
<dt id="buildingspy.development.unittest.Tester.deleteTemporaryDirectories">
<tt class="descname">deleteTemporaryDirectories</tt><big>(</big><em>delete</em><big>)</big><a class="headerlink" href="#buildingspy.development.unittest.Tester.deleteTemporaryDirectories" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag, if set to <tt class="xref docutils literal"><span class="pre">False</span></tt>, then the temporary directories will not be deleted
after the unit tests are run.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>delete</em> &#8211; Flag, set to <tt class="xref docutils literal"><span class="pre">False</span></tt> to avoid the temporary directories to be deleted.</td>
</tr>
</tbody>
</table>
<p>Unless this method is called prior to running the unit tests with <tt class="docutils literal"><span class="pre">delete=False</span></tt>,
all temporary directories will be deleted after the unit tests.</p>
</dd></dl>

<dl class="method">
<dt id="buildingspy.development.unittest.Tester.getDataDictionary">
<tt class="descname">getDataDictionary</tt><big>(</big><big>)</big><a class="headerlink" href="#buildingspy.development.unittest.Tester.getDataDictionary" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of variables that are in the plot command and the associate <tt class="docutils literal"><span class="pre">*.mat</span></tt> file name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A dictionary with keys equal to the <tt class="docutils literal"><span class="pre">*.mos</span></tt> file name, and values
containing a dictionary with keys <tt class="docutils literal"><span class="pre">matFil</span></tt> and <tt class="docutils literal"><span class="pre">y</span></tt>.</p>
<p class="last">The values of <tt class="docutils literal"><span class="pre">y</span></tt> are a list of the 
form <cite>[[a.x, a.y], [b.x, b.y1, b.y2]]</cite> if the
mos file plots <cite>a.x</cite> versus <cite>a.y</cite> and <cite>b.x</cite> versus <cite>(b.y1, b.y2)</cite>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="buildingspy.development.unittest.Tester.getModelicaCommand">
<tt class="descname">getModelicaCommand</tt><big>(</big><big>)</big><a class="headerlink" href="#buildingspy.development.unittest.Tester.getModelicaCommand" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the name of the modelica executable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Returns:</th><td class="field-body">The name of the modelica executable.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="buildingspy.development.unittest.Tester.run">
<tt class="descname">run</tt><big>(</big><big>)</big><a class="headerlink" href="#buildingspy.development.unittest.Tester.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs all unit tests and checks the results.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Returns:</th><td class="field-body">0 if no errros occurred during the unit tests, 
otherwise a non-zero value.</td>
</tr>
</tbody>
</table>
<p>This method</p>
<ul class="simple">
<li>creates temporary directories for each processors,</li>
<li>copies the directory &#8216;Buildings&#8217; into these
temporary directories,</li>
<li>creates run scripts that run all unit tests,</li>
<li>runs these unit tests,</li>
<li>collects the dymola log files from each process,</li>
<li>writes the combined log file <tt class="docutils literal"><span class="pre">unitTests.log</span></tt>
to the current directory,</li>
<li>compares the results of the new simulations with
reference results that are stored in <tt class="docutils literal"><span class="pre">Resources/ReferenceResults</span></tt>,</li>
<li>writes the message <cite>Unit tests completed successfully.</cite> 
if no error occured,</li>
<li>returns 0 if no errors occurred, or non-zero otherwise.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="buildingspy.development.unittest.Tester.setNumberOfThreads">
<tt class="descname">setNumberOfThreads</tt><big>(</big><em>number</em><big>)</big><a class="headerlink" href="#buildingspy.development.unittest.Tester.setNumberOfThreads" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the number of parallel threads that are used to run the unit tests.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>number</em> &#8211; The number of parallel threads that are used to run the unit tests.</td>
</tr>
</tbody>
</table>
<p>By default, the number of parallel threads are set to be equal to the number of
processors of the computer.</p>
</dd></dl>

<dl class="method">
<dt id="buildingspy.development.unittest.Tester.useExistingResults">
<tt class="descname">useExistingResults</tt><big>(</big><em>dirs</em><big>)</big><a class="headerlink" href="#buildingspy.development.unittest.Tester.useExistingResults" title="Permalink to this definition">¶</a></dt>
<dd><p>This function allows to use existing results, as opposed to running a simulation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>dirs</em> &#8211; A non-empty list of directories that contain existing results.</td>
</tr>
</tbody>
</table>
<p>This method can be used for testing and debugging. If called, then no simulation is
run. Use as</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">buildingspy.development.unittest</span> <span class="kn">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Tester</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">useExistingResults</span><span class="p">([</span><span class="s">&#39;/tmp/tmp-Buildings-0-zABC44&#39;</span><span class="p">,</span> <span class="s">&#39;/tmp/tmp-Buildings-0-zQNS41&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>This method assumes that the directories <tt class="docutils literal"><span class="pre">['/tmp/tmp-Buildings-0-zABC44',</span> <span class="pre">'/tmp/tmp-Buildings-0-zQNS41']</span></tt>
contain previous results.</p>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="legal.html" title="Copyright and License"
             >next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             >previous</a> |</li>
        <li><a href="index.html">BuildingsPy v0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2011, The Regents of the University of California (through Lawrence Berkeley National Laboratory), subject to receipt of any required approvals from U.S. Department of Energy.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.6.
    </div>
  </body>
</html>